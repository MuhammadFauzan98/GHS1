{% extends "base.html" %}

{% block title %}Faculty Dashboard - Global High School{% endblock %}

{% block content %}
<section class="faculty-dashboard">
    <div class="container">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h2>Faculty Dashboard</h2>
            <p>Welcome back, {{ current_user.name }}!</p>
            <div class="user-info">
                <span class="user-role">{{ current_user.role }}</span>
                <span class="last-login">
                    Last login: {{ current_user.last_login.strftime('%d %b %Y at %H:%M') if current_user.last_login else 'First login' }}
                </span>
            </div>
        </div>

        <!-- Stats -->
        <div class="dashboard-stats">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-file-pdf"></i>
                </div>
                <div class="stat-info">
                    <h3>{{ pyqp_count }}</h3>
                    <p>PYQP Uploaded</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-calendar"></i>
                </div>
                <div class="stat-info">
                    <h3>{{ current_user.last_login.strftime('%d %b') if current_user.last_login else 'N/A' }}</h3>
                    <p>Last Active</p>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="dashboard-actions">
            <h3>Quick Actions</h3>
            <div class="action-grid">
                <a href="{{ url_for('faculty_upload_pyqp') }}" class="action-card">
                    <i class="fas fa-file-upload"></i>
                    <h4>Upload PYQP</h4>
                    <p>Add previous year question papers</p>
                    <span class="action-arrow">→</span>
                </a>
                <a href="{{ url_for('pyqp') }}" class="action-card">
                    <i class="fas fa-book-open"></i>
                    <h4>View PYQP</h4>
                    <p>Check all question papers</p>
                    <span class="action-arrow">→</span>
                </a>
            </div>
        </div>

        <!-- Recently Uploaded PYQP -->
        <div class="activity-section">
            <h3>Recently Uploaded PYQP</h3>
            {% if recent_pyqps %}
            <div class="activity-list">
                {% for pyqp in recent_pyqps %}
                <div class="activity-item">
                    <i class="fas fa-file-pdf"></i>
                    <div class="activity-info">
                        <h5>{{ pyqp.subject }} - {{ pyqp.year }}</h5>
                        <p>Uploaded on {{ pyqp.uploaded_at.strftime('%d %b %Y at %H:%M') }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-activity">No PYQP uploaded yet.</p>
            {% endif %}
        </div>

        <!-- Recent Activity -->
        <div class="activity-section">
            <h3>Recent Activity</h3>
            {% if recent_activities %}
            <div class="activity-list">
                {% for activity in recent_activities %}
                <div class="activity-item">
                    <i class="fas fa-{{ 
                        'sign-in-alt' if activity.action == 'login' else 
                        'sign-out-alt' if activity.action == 'logout' else 
                        'file-pdf' if activity.action == 'upload_pyqp' else 
                        'user-edit' if activity.action == 'update_profile' else 'history' 
                    }}"></i>
                    <div class="activity-info">
                        <h5>{{ activity.action|replace('_', ' ')|title }}</h5>
                        <p>{{ activity.created_at.strftime('%d %b %Y at %H:%M') }}</p>
                        {% if activity.details %}
                        <small>{{ activity.details }}</small>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-activity">No activity recorded yet.</p>
            {% endif %}
        </div>
    </div>
</section>

<style>
/* Dashboard Section */
.faculty-dashboard { padding: 40px 0; min-height: 100vh; background-color: #f8f9fa; }

.dashboard-header { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px; }
.dashboard-header h2 { color: var(--dark-blue); margin-bottom: 10px; }
.dashboard-header p { color: var(--dark-gray); margin-bottom: 15px; font-size: 1.1rem; }
.user-info { display: flex; gap: 20px; flex-wrap: wrap; }
.user-role { background: var(--light-blue); color: var(--primary-blue); padding: 5px 12px; border-radius: 20px; font-size: 0.9rem; font-weight: 600; }
.last-login { color: var(--dark-gray); font-size: 0.9rem; }

.dashboard-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px; }
.stat-card { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 20px; transition: var(--transition); }
.stat-card:hover { transform: translateY(-5px); box-shadow: 0 5px 20px rgba(0,0,0,0.15); }
.stat-icon { width: 60px; height: 60px; background: var(--light-blue); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: var(--primary-blue); }
.stat-info h3 { font-size: 2.5rem; margin: 0; color: var(--dark-blue); }
.stat-info p { margin: 5px 0 0; color: var(--dark-gray); }

.dashboard-actions { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px; }
.dashboard-actions h3 { color: var(--dark-blue); margin-bottom: 25px; }
.action-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
.action-card { background: var(--light-gray); padding: 25px; border-radius: 10px; text-decoration: none; color: inherit; transition: var(--transition); position: relative; border: 2px solid transparent; }
.action-card:hover { background: white; border-color: var(--primary-blue); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
.action-card i { font-size: 2rem; color: var(--primary-blue); margin-bottom: 15px; display: block; }
.action-card h4 { color: var(--dark-blue); margin-bottom: 10px; }
.action-card p { color: var(--dark-gray); margin: 0; line-height: 1.5; }
.action-arrow { position: absolute; top: 25px; right: 25px; color: var(--primary-blue); font-size: 1.2rem; transition: var(--transition); }
.action-card:hover .action-arrow { transform: translateX(5px); }

.activity-section { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px; }
.activity-section h3 { color: var(--dark-blue); margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--light-blue); }
.activity-list { display: flex; flex-direction: column; gap: 15px; }
.activity-item { display: flex; align-items: center; gap: 15px; padding: 15px 0; border-bottom: 1px solid #f0f0f0; }
.activity-item:last-child { border-bottom: none; }
.activity-item i { width: 40px; height: 40px; background: var(--light-blue); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary-blue); font-size: 1.1rem; }
.activity-info h5 { margin: 0 0 5px; color: var(--dark-blue); }
.activity-info p { margin: 0; color: var(--dark-gray); font-size: 0.9rem; }
.activity-info small { color: #6c757d; font-size: 0.8rem; }
.no-activity { color: var(--dark-gray); font-style: italic; text-align: center; padding: 20px; }

@media (max-width: 1200px) { .recent-activity { grid-template-columns: 1fr 1fr; } }
@media (max-width: 992px) { .recent-activity { grid-template-columns: 1fr; } .dashboard-stats { grid-template-columns: 1fr; } }
@media (max-width: 768px) { .action-grid { grid-template-columns: 1fr; } .user-info { flex-direction: column; gap: 10px; } }
</style>
{% endblock %}
